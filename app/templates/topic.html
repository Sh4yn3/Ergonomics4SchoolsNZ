{% extends "layout.html" %}
{% block content %}
<head>
  <link rel="stylesheet" href="/static/topicstyle.css">
</head>

<div class="textbox">

<section id="topic">
  <div class="header">
    <div class="what">
      <h1> {{ topic.name.upper() }} </h1>
    </div>
    <div class="date">
      <p> Published: {{ topic.created_on }} | Updated: {{ topic.last_updated_on }} </p>
    </div>

  </div>
  <div class="container">
    <div id="myBtnContainer">
      <button class="btn" data-category="about" onclick="filterSelection('about')"> About </button>
      <button class="btn" data-category="faq" onclick="filterSelection('faq')"> FaQs </button>
      <button class="btn" data-category="resources" onclick="filterSelection('resources')"> Resources </button>
    </div>
    
    <!-- CATEGORY: ABOUT ERGONOMICS -->
    <div class="category about">
      <div class="titlecard">
        <img src="/static/image/ergonomics_1_wall.jpg" alt="wall" oncontextmenu="return false;" draggable="false">
        <div class="title"><h2> {{ topic.heading | safe }} </h2></div>
      </div>
      <div class="intro">
        {{ topic.introduction | safe }}
      </div>

      <div class="segment"> <!-- Article Segments -->
        {% for article in articles %}
          <br>
          <div class="h3-title">
            <h3> {{ article.title }} </h3>
          </div>
          <h4> {{ article.subheading | safe }} </h4>
          <p> {{ article.content | safe }} </p>
        {% endfor %}
      </div>
    </div> <!-- END OF ABOUT -->

    <!-- CATEGORY: FREQUENTLY ASKED QUESTIONS -->
    <div class="category faq">
        <div class="">
          
        </div>
    </div> <!-- END OF FAQs -->
        

    <!-- CATEGORY: RESOURCES FOR ERGONOMICS -->
    <div class="category resources">
        <p> resources </p>
    </div> <!-- END OF RESOURCES -->
</div> <!-- END OF CONTAINER -->
</section>

</div>

<!-- Based on W3Schools.com -->
<script>
function filterSelection(c) {
  var x, i;
  x = document.getElementsByClassName("category");
  for (i = 0; i < x.length; i++) {
    w3RemoveClass(x[i], "show");
    if (x[i].className.indexOf(c) > -1) w3AddClass(x[i], "show");
  }

  // Store active category in localStorage
  localStorage.setItem("activeCategory", c);
}

function w3AddClass(element, name) {
  var i, arr1, arr2;
  arr1 = element.className.split(" ");
  arr2 = name.split(" ");
  for (i = 0; i < arr2.length; i++) {
    if (arr1.indexOf(arr2[i]) == -1) {
      element.className += " " + arr2[i];
    }
  }
}

function w3RemoveClass(element, name) {
  var i, arr1, arr2;
  arr1 = element.className.split(" ");
  arr2 = name.split(" ");
  for (i = 0; i < arr2.length; i++) {
    while (arr1.indexOf(arr2[i]) > -1) {
      arr1.splice(arr1.indexOf(arr2[i]), 1);
    }
  }
  element.className = arr1.join(" ");
}

// Add active class to the current button (highlight it)
var btnContainer = document.getElementById("myBtnContainer");
var btns = btnContainer.getElementsByClassName("btn");
for (var i = 0; i < btns.length; i++) {
  btns[i].addEventListener("click", function () {
    var current = document.querySelector(".btn.active");
    if (current) {
      current.classList.remove("active");
    }
    this.classList.add("active");
  });
}

// On page load, set the last active category
document.addEventListener("DOMContentLoaded", function () {
  var active = localStorage.getItem("activeCategory") || "about";
  filterSelection(active);

  // Set the active button visually
  var btns = document.querySelectorAll("#myBtnContainer .btn");
  btns.forEach(function (btn) {
    if (btn.getAttribute("data-category") === active) {
      btn.classList.add("active");
    } else {
      btn.classList.remove("active");
    }
  });
});
</script>

<script>
  // On page load, apply stored theme
  window.addEventListener("DOMContentLoaded", () => {
    const savedTheme = localStorage.getItem("theme");
    if (savedTheme === "light") {
      document.body.classList.add("lightmode");
    } else {
      document.body.classList.remove("lightmode");
    }
  });
</script>

{% endblock %}